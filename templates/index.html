{% extends "base.html" %} {% block content %}
<!-- Dashboard -->
<div id="dashboard" class="aba-conteudo active">
  <div class="page-title">
    <h2>Dashboard</h2>
  </div>

  <div class="cards-grid">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Total de Vendas</h3>
        <div class="card-icon primary">
          <i class="fas fa-shopping-cart"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalVendas">R$ 0,00</div>
        <div class="stat-label">Receita total do dia</div>
        <div class="stat-change positive">
          <i class="fas fa-arrow-up"></i>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Vendas Fiadas</h3>
        <div class="card-icon warning">
          <i class="fas fa-store"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalFiado">R$ 0,00</div>
        <div class="stat-label">Valor total em fiado</div>
        <div class="stat-change negative">
          <i class="fas fa-arrow-up"></i>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Produtos Vendidos</h3>
        <div class="card-icon success">
          <i class="fas fa-boxes"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalProdutos">0</div>
        <div class="stat-label">Itens vendidos hoje</div>
        <div class="stat-change positive">
          <i class="fas fa-arrow-up"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="cards-grid">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Vendas Recentes</h3>
        <a href="#" class="btn btn-primary" onclick="mostrarAba('vendas')"
          >Ver todas</a
        >
      </div>
      <div class="card-body">
        <div class="table-container">
          <table id="vendasRecentes">
            <thead>
              <tr>
                <th>ID</th>
                <th>Data</th>
                <th>Valor</th>
                <th>Vendedor</th>
                <th>Pagamento</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="text-center">Carregando...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Produtos Mais Vendidos</h3>
        <a href="#" class="btn btn-primary" onclick="mostrarAba('produtos')"
          >Ver todos</a
        >
      </div>
      <div class="card-body">
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Produto</th>
                <th>Categoria</th>
                <th>Vendas</th>
                <th>Valor Total</th>
              </tr>
            </thead>
            <tbody id="produtosMaisVendidos">
              <tr>
                <td colspan="4" class="text-center">Carregando...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Vendas -->
<div id="vendas" class="aba-conteudo">
  <div class="page-title">
    <h2>Registrar Venda</h2>
    <button class="btn btn-primary" onclick="exportarPlanilha()">
      Exportar Planilha
    </button>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Nova Venda</h3>
    </div>
    <div class="card-body">
      <div id="produtos-venda">
        <!-- Produtos serão adicionados aqui -->
      </div>

      <button
        class="btn btn-primary"
        onclick="adicionarProduto()"
        style="margin-bottom: 1.5rem"
      >
        <i class="fas fa-plus"></i> Adicionar Produto
      </button>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Vendedor</label>
          <select class="form-control" id="vendedor">
            <option value="">Selecione o vendedor</option>
          </select>
          <small
            ><a href="#" onclick="mostrarAba('funcionarios')"
              >Cadastrar novo funcionário</a
            ></small
          >
        </div>

        <div class="form-group">
          <label class="form-label">Método de Pagamento</label>
          <select class="form-control" id="metodo-pagamento">
            <option value="dinheiro">Dinheiro</option>
            <option value="debito">Débito</option>
            <option value="credito">Crédito</option>
            <option value="pix">PIX</option>
          </select>
        </div>
      </div>

      <div class="form-group" id="parcelas-group" style="display: none">
        <label class="form-label">Número de Parcelas</label>
        <input
          type="number"
          class="form-control"
          id="parcelas"
          min="1"
          max="12"
          value="1"
        />
      </div>

      <div class="total-value" id="total-venda">Total: R$ 0,00</div>

      <button
        class="btn btn-success"
        onclick="confirmarVenda()"
        style="width: 100%; padding: 1rem; margin-top: 1rem"
      >
        <i class="fas fa-check"></i> CONFIRMAR VENDA
      </button>
    </div>
  </div>

  <div class="card" style="margin-top: 2rem">
    <div class="card-header">
      <h3 class="card-title">Histórico de Vendas</h3>
      <div class="filters">
        <select id="filtro-vendas" onchange="filtrarVendas()">
          <option value="todos">Todas as vendas</option>
          <option value="hoje">Hoje</option>
          <option value="semana">Esta semana</option>
          <option value="mes">Este mês</option>
        </select>
      </div>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table id="tabela-vendas">
          <thead>
            <tr>
              <th>ID</th>
              <th>Data</th>
              <th>Valor</th>
              <th>Vendedor</th>
              <th>Pagamento</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" class="text-center">Carregando...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Lojas (Fiado) -->
<div id="lojas-fiado" class="aba-conteudo">
  <div class="page-title">
    <h2>Registrar Venda Fiada</h2>
    <button class="btn btn-primary" onclick="exportarPlanilha('lojas')">
      Exportar Planilha
    </button>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Nova Venda Fiada</h3>
    </div>
    <div class="card-body">
      <div class="form-group">
        <label class="form-label">Data do Serviço</label>
        <input type="date" class="form-control" id="data-servico" value="" />
      </div>

      <div class="form-group">
        <label class="form-label">Loja</label>
        <select class="form-control" id="loja-fiado">
          <option value="">Selecione a loja</option>
        </select>
        <small
          ><a href="#" onclick="mostrarAba('lojas-fiado')"
            >Cadastrar nova loja</a
          ></small
        >
      </div>

      <div id="produtos-fiado">
        <!-- Produtos fiados serão adicionados aqui -->
      </div>

      <button
        class="btn btn-primary"
        onclick="adicionarProdutoFiado()"
        style="margin-bottom: 1.5rem"
      >
        <i class="fas fa-plus"></i> Adicionar Produto
      </button>

      <div class="form-group">
        <label class="form-label">Funcionário</label>
        <input
          type="text"
          class="form-control"
          id="funcionario-fiado"
          placeholder="Digite o nome do funcionário"
        />
      </div>

      <div class="total-value" id="total-fiado">Total: R$ 0,00</div>

      <button
        class="btn btn-success"
        onclick="confirmarVendaFiada()"
        style="width: 100%; padding: 1rem; margin-top: 1rem"
      >
        <i class="fas fa-check"></i> CONFIRMAR VENDA FIADA
      </button>
    </div>
  </div>

  <div class="card" style="margin-top: 2rem">
    <div class="card-header">
      <h3 class="card-title">Contas a Receber</h3>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Loja</th>
              <th>Total em Fiado</th>
              <th>Última Venda</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="contasReceber">
            <tr>
              <td colspan="4" class="text-center">Carregando...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Funcionários -->
<div id="funcionarios" class="aba-conteudo">
  <div class="page-title">
    <h2>Gerenciar Funcionários</h2>
    <button class="btn btn-primary" onclick="limparFormularioFuncionario()">
      Novo Funcionário
    </button>
  </div>

  <div class="cards-grid">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Cadastro de Funcionário</h3>
        <div class="card-icon primary">
          <i class="fas fa-user-plus"></i>
        </div>
      </div>
      <div class="card-body">
        <form id="formFuncionario">
          <input type="hidden" id="funcionarioId" />

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="nomeFuncionario">Nome:</label>
              <input
                type="text"
                id="nomeFuncionario"
                name="nome"
                class="form-control"
                required
                placeholder="Digite o nome completo"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="dataEntrada"
                >Data de Entrada:</label
              >
              <input
                type="date"
                id="dataEntrada"
                name="data_entrada"
                class="form-control"
                required
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="cargo">Cargo:</label>
              <select id="cargo" name="cargo" class="form-control">
                <option value="Vendedor">Vendedor</option>
                <option value="Gerente">Gerente</option>
                <option value="Administrativo">Administrativo</option>
                <option value="Entregador">Entregador</option>
                <option value="Outro">Outro</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="salario">Salário (R$):</label>
              <input
                type="number"
                id="salario"
                name="salario"
                class="form-control"
                step="0.01"
                min="0"
                placeholder="0,00"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="telefoneFuncionario"
                >Telefone:</label
              >
              <input
                type="tel"
                id="telefoneFuncionario"
                name="telefone"
                class="form-control"
                placeholder="(00) 00000-0000"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="email">E-mail:</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-control"
                placeholder="email@exemplo.com"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Status:</label>
            <div style="display: flex; align-items: center; gap: 0.5rem">
              <input
                type="checkbox"
                id="ativo"
                name="ativo"
                checked
                style="width: auto"
              />
              <label for="ativo" style="margin: 0">Ativo</label>
            </div>
          </div>

          <div
            class="flex gap-2"
            style="display: flex; gap: 0.5rem; margin-top: 1.5rem"
          >
            <button
              type="button"
              onclick="salvarFuncionario()"
              id="btnSalvarFuncionario"
              class="btn btn-primary"
            >
              <i class="fas fa-save"></i> Cadastrar Funcionário
            </button>
            <button
              type="button"
              onclick="limparFormularioFuncionario()"
              class="btn btn-secondary"
            >
              <i class="fas fa-broom"></i> Limpar
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Resumo da Equipe</h3>
        <div class="card-icon success">
          <i class="fas fa-users"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalFuncionarios">0</div>
        <div class="stat-label">Funcionários ativos</div>

        <div style="margin-top: 1.5rem">
          <div
            class="stat-value"
            style="font-size: 1.5rem"
            id="totalVendedores"
          >
            0
          </div>
          <div class="stat-label">Vendedores</div>
        </div>

        <div style="margin-top: 1rem">
          <div
            class="stat-value"
            style="font-size: 1.5rem"
            id="totalAdministrativos"
          >
            0
          </div>
          <div class="stat-label">Administrativos</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Lista de Funcionários</h3>
      <div class="filters">
        <select id="filtroCargo" style="margin-right: 1rem">
          <option value="">Todos os cargos</option>
          <option value="Vendedor">Vendedor</option>
          <option value="Gerente">Gerente</option>
          <option value="Administrativo">Administrativo</option>
          <option value="Entregador">Entregador</option>
        </select>
        <input
          type="text"
          id="buscarFuncionario"
          placeholder="Buscar funcionário..."
          class="form-control"
          style="width: 250px"
        />
      </div>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Cargo</th>
              <th>Data de Entrada</th>
              <th>Salário</th>
              <th>Telefone</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="tabelaFuncionarios">
            <tr>
              <td colspan="7" class="text-center">Carregando...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Lojas -->
<div id="lojas" class="aba-conteudo">
  <div class="page-title">
    <h2>Gerenciamento de Lojas</h2>
    <button class="btn btn-primary" onclick="limparFormularioLoja()">
      Nova Loja
    </button>
  </div>

  <div class="cards-grid">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Cadastro de Loja</h3>
        <div class="card-icon primary">
          <i class="fas fa-store"></i>
        </div>
      </div>
      <div class="card-body">
        <form id="formLoja">
          <input type="hidden" id="lojaId" />

          <div class="form-group">
            <label class="form-label" for="nomeLoja">Nome da Loja:</label>
            <input
              type="text"
              id="nomeLoja"
              name="nome"
              class="form-control"
              required
              placeholder="Digite o nome da loja"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="telefoneLoja">Telefone:</label>
              <input
                type="tel"
                id="telefoneLoja"
                name="telefone"
                class="form-control"
                placeholder="(00) 00000-0000"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="responsavel">Responsável:</label>
              <input
                type="text"
                id="responsavel"
                name="responsavel"
                class="form-control"
                placeholder="Nome do responsável"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="enderecoLoja">Endereço:</label>
            <textarea
              id="enderecoLoja"
              name="endereco"
              class="form-control"
              rows="3"
              placeholder="Digite o endereço completo"
            ></textarea>
          </div>

          <div class="form-group">
            <label class="form-label" for="limiteCredito"
              >Limite de Crédito (R$):</label
            >
            <input
              type="number"
              id="limiteCredito"
              name="limite_credito"
              class="form-control"
              step="0.01"
              min="0"
              placeholder="0,00"
            />
          </div>

          <div
            class="flex gap-2"
            style="display: flex; gap: 0.5rem; margin-top: 1.5rem"
          >
            <button
              type="button"
              onclick="salvarLoja()"
              id="btnSalvarLoja"
              class="btn btn-primary"
            >
              <i class="fas fa-save"></i> Cadastrar Loja
            </button>
            <button
              type="button"
              onclick="limparFormularioLoja()"
              class="btn btn-secondary"
            >
              <i class="fas fa-broom"></i> Limpar
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Resumo Financeiro</h3>
        <div class="card-icon warning">
          <i class="fas fa-chart-pie"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalLojas">0</div>
        <div class="stat-label">Lojas cadastradas</div>

        <div style="margin-top: 1.5rem">
          <div
            class="stat-value"
            style="font-size: 1.5rem"
            id="totalFiadoGeral"
          >
            R$ 0,00
          </div>
          <div class="stat-label">Total em fiado</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Lista de Lojas</h3>
      <div class="filters">
        <input
          type="text"
          id="buscarLoja"
          placeholder="Buscar loja..."
          class="form-control"
          style="width: 250px"
        />
      </div>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Telefone</th>
              <th>Responsável</th>
              <th>Limite Crédito</th>
              <th>Fiado Atual</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="tabelaLojas">
            <tr>
              <td colspan="7" class="text-center">Carregando...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Produtos -->
<div id="produtos" class="aba-conteudo">
  <div class="page-title">
    <h2>Gerenciar Produtos</h2>
    <button class="btn btn-primary" onclick="limparFormularioProduto()">
      Novo Produto
    </button>
  </div>

  <div class="cards-grid">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Cadastro de Produto</h3>
        <div class="card-icon primary">
          <i class="fas fa-box"></i>
        </div>
      </div>
      <div class="card-body">
        <form id="formProduto">
          <input type="hidden" id="produtoId" />

          <div class="form-group">
            <label class="form-label" for="nomeProduto">Nome do Produto:</label>
            <input
              type="text"
              id="nomeProduto"
              name="nome"
              class="form-control"
              required
              placeholder="Digite o nome do produto"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="subcategoria"
                >Subcategoria (opcional):</label
              >
              <input
                type="text"
                id="subcategoria"
                name="subcategoria"
                class="form-control"
                placeholder="Ex: Colorido, A4, etc."
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="valor">Valor (R$):</label>
              <input
                type="number"
                id="valor"
                name="valor"
                step="0.01"
                min="0"
                class="form-control"
                required
                placeholder="0,00"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Status:</label>
            <div style="display: flex; align-items: center; gap: 0.5rem">
              <input
                type="checkbox"
                id="ativoProduto"
                name="ativo"
                checked
                style="width: auto"
              />
              <label for="ativoProduto" style="margin: 0">Ativo</label>
            </div>
          </div>

          <div
            class="flex gap-2"
            style="display: flex; gap: 0.5rem; margin-top: 1.5rem"
          >
            <button
              type="button"
              onclick="salvarProduto()"
              id="btnSalvarProduto"
              class="btn btn-primary"
            >
              <i class="fas fa-save"></i> Cadastrar Produto
            </button>
            <button
              type="button"
              onclick="limparFormularioProduto()"
              class="btn btn-secondary"
            >
              <i class="fas fa-broom"></i> Limpar
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Resumo de Produtos</h3>
        <div class="card-icon success">
          <i class="fas fa-chart-bar"></i>
        </div>
      </div>
      <div class="card-body">
        <div class="stat-value" id="totalProdutosCadastrados">0</div>
        <div class="stat-label">Produtos cadastrados</div>

        <div style="margin-top: 1.5rem">
          <div
            class="stat-value"
            style="font-size: 1.5rem"
            id="totalProdutosAtivos"
          >
            0
          </div>
          <div class="stat-label">Produtos ativos</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Lista de Produtos</h3>
      <div class="filters" style="display: flex; gap: 1rem">
        <input
          type="text"
          id="buscarProduto"
          placeholder="Buscar produto..."
          class="form-control"
          style="width: 250px"
        />
        <select id="filtroCategoria" class="form-control" style="width: 200px">
          <option value="">Todas as categorias</option>
          <option value="Papel">Papel</option>
          <option value="Impressão">Impressão</option>
          <option value="Encadernação">Encadernação</option>
          <option value="Outro">Outro</option>
        </select>
      </div>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Subcategoria</th>
              <th>Valor</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="tabelaProdutos">
            <tr>
              <td colspan="5" class="text-center">Carregando...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script src="/static/js/produtos.js"></script>
<script src="/static/js/vendas.js"></script>
<script src="/static/js/servicos.js"></script>
{% endblock %}
